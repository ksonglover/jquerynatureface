/*!
 * jquery.NatureFace.js JavaScript Library 
 * http://jquerynatureface.ksonglover.com/
 *
 * Copyright 2003~2015, jquerynatureFace.com
 *
 *  version : v2.15.19
 *
 * 此程式主要用途為產生互動式web應用程式之操作介面。
 * 並搭配一些簡單的操作，就可完成一個應用程式互動介面。
 * 此程式「使用創用CC 姓名標示─非商業性─禁止改作 3.0 台灣 授權條款」
 * 如做為商業用途，請利用Paypal進行付費授權，另外任何使用請保留此註記。
 * 
 */

var NatureFaceOrig=function(){if($.event.special.target==undefined){$.extend($.event.special,{refresh:{listeners:[],setup:function(){var c=this,b=$(c);$.event.special.refresh.listeners.push(b)},teardown:function(){var c=this,b=$(c);$.event.special.refresh.listeners=$.grep($.event.special.refresh.listeners,function(e,d){return b[0]!=e[0]})}},target:{listeners:[],setup:function(){var c=this,b=$(c);$.event.special.target.listeners.push(b)},teardown:function(){var c=this,b=$(c);$.event.special.target.listeners=$.grep($.event.special.target.listeners,function(e,d){return b[0]!=e[0]})}},preEnter:{listeners:[],setup:function(){var c=this,b=$(c);$.event.special.preEnter.listeners.push(b)},teardown:function(){var c=this,b=$(c);$.event.special.preEnter.listeners=$.grep($.event.special.preEnter.listeners,function(e,d){return b[0]!=e[0]})}},postEnter:{listeners:[],setup:function(){var c=this,b=$(c);$.event.special.postEnter.listeners.push(b)},teardown:function(){var c=this,b=$(c);$.event.special.postEnter.listeners=$.grep($.event.special.postEnter.listeners,function(e,d){return b[0]!=e[0]})}},preExit:{listeners:[],setup:function(){var c=this,b=$(c);$.event.special.preExit.listeners.push(b)},teardown:function(){var c=this,b=$(c);$.event.special.preExit.listeners=$.grep($.event.special.preExit.listeners,function(e,d){return b[0]!=e[0]})}},postExit:{listeners:[],setup:function(){var c=this,b=$(c);$.event.special.postExit.listeners.push(b)},teardown:function(){var c=this,b=$(c);$.event.special.postExit.listeners=$.grep($.event.special.postExit.listeners,function(e,d){return b[0]!=e[0]})}}});if($.fn.autofill==undefined){$.fn.autofill=function(c){var d={maxFontPixels:40,minFontPixels:4,innerTag:"div"};var b=$.extend(d,c);return this.each(function(){if(!$(this).is(":visible")){return}var g=parseInt($(this).css("font-size")||b.maxFontPixels);if($(b.innerTag,this).size()==0){if(!$(this).data("orig")){$(this).data("orig",{top:parseFloat($(this).css("top")),left:parseFloat($(this).css("left")),w:$(this).width(),h:$(this).height()})}var l=$(this).data("orig");var h=g;var k;var j;$(this).css({width:"",height:"","line-height":""});do{$(this).css({"font-size":h+"px"});k=$(this).height();j=$(this).width();h=h-1}while((k>l.h||j>l.w)&&h>b.minFontPixels);$(this).css({width:l.w,height:l.h+10})}else{$(this).css({"line-height":""});var f=$(this).height();var e=$(this).width();$(b.innerTag,this).each(function(){var m=g;$(this).css({width:""});var o;var n;do{$(this).css({"font-size":m+"px"});o=$(this).height();n=$(this).width();m=m-1}while((o>f||n>e)&&m>b.minFontPixels);if($(this).parent().css("text-align")=="right"){$(this).css({left:((e-n))+"px",top:((f-o)/2)+"px"})}else{if($(this).parent().css("text-align")=="center"){$(this).css({left:((e-n)/2)+"px",top:((f-o)/2)+"px"})}else{$(this).css({left:"0px",top:((f-o)/2)+"px"})}}})}})}}}function a(d,k,g,h,f,j,e,c,l,b,m){this.init(d,k,g,h,f,j,e,c,l,b,m)}a.prototype={settings:{},init:function(d,l,h,j,f,k,e,c,m,b,n,g){if(typeof d=="string"){return this.start(d,l,h,j,f,k,e,c,m,b,n,g)}else{if(typeof d=="object"){return this.start(d.theme,d.fullscreen,d.prefix,d.firsttarget,d.touch,d.top,d.left,d.width,d.height,d.rootdiv,d.zindex,d.html,d.pages,d.disablejs,d.transparent)}}return},start:function(g,o,j,l,f,m,e,c,p,b,q,h,d,n,t){var k=false;this.settings={theme:g,fullscreen:o,prefix:(j?j:""),firsttarget:((l)?l:g),touch:((typeof f!="undefined")?f:(!!("undefined"!=typeof document.documentElement.ontouchstart))),top:((m&&!o)?m:0),left:((e&&!o)?e:0),width:((c&&p&&!o)?function(){k=true;return parseInt(c)}.call():$(window).width()),height:((c&&p&&!o)?parseInt(p):$(window).height()),zindex:(q?q:1),html:h,pages:d,disablejs:n,transparent:(t?t:false),divName:(b?b:"NatureFace_"+g),div:"#"+(b?b:"NatureFace_"+g),hasSize:k,noname:0,sizeH:1,sizeW:1,elements:{},files:[],groups:{},listeners:{},self:this,hide:false,globalLoadingTarget:"NatureFaceGlobalLoadingGlassBoard",spinners:{},loadingOpts:{lines:13,length:7,width:4,radius:10,corners:1,rotate:0,color:"#ffff00",speed:1,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000,top:"auto",left:"auto"}};var r=this.settings;$("body").css({margin:"0px",overflow:"hidden"});if($(r.div).length==0){$("body").append('<div id="'+r.divName+'"/>')}$(r.div).css({"-moz-user-select":"none",top:r.top,left:r.left,position:"absolute"}).append('<div id="template"/><div id="layer"/><div id="'+r.globalLoadingTarget+'"/>');$("#"+r.globalLoadingTarget,r.div).css({width:r.width+"px",height:r.height+"px",top:r.top,left:r.left,opacity:0.7,"z-index":2000000000,position:"absolute",display:"none"});$(r.div).get(0).onselectstart=function(){return false};if(r.html){this.parseHTML(r.html)}else{if(r.pages){$.each(r.pages,function(s,u){r.self.loadfile(u,r.prefix)})}else{this.loadfile(g,r.prefix)}}this.convertTags();this.initLayer().target(r.firsttarget);this.autofill();return this},loading:function(c,g,d){var e=this.settings;if(!g){g=e.globalLoadingTarget}if(window.Spinner){if(c){$("#"+g,e.div).show();if(e.spinners[g]){e.spinners[g].spin(document.getElementById(g))}else{var f=document.getElementById(g);if(d){e.spinners[g]=new Spinner(d).spin(f)}else{e.spinners[g]=new Spinner(e.loadingOpts).spin(f)}}}else{if(g==e.globalLoadingTarget){$("#"+g,e.div).hide()}if(e.spinners[g]){e.spinners[g].stop()}}}},refresh:function(){var c=this.settings;if(c.fullscreen&&c.height!=0&&c.width!=0){c.sizeH=$(window).height()/c.height;c.sizeW=$(window).width()/c.width;c.height=$(window).height();c.width=$(window).width();$("#"+c.globalLoadingTarget,c.div).css({width:c.width,height:c.height});$("[id^=_backgroupimage_]",c.div).css({width:c.width,height:c.height});var b=function(){var d={top:parseFloat($(this).css("top"))*c.sizeH,left:parseFloat($(this).css("left"))*c.sizeW,width:parseFloat($(this).css("width"))*c.sizeW,height:parseFloat($(this).css("height"))*c.sizeH};$.extend(d,{"line-height":(d.height-2)+"px","background-position":(c.transparent?"":("-"+d.left+"px -"+d.top+"px")),"background-size":(c.transparent?"":(c.width+"px "+c.height+"px"))});if($(this).hasClass("NatureGroupObject")){$.extend(d,{"line-height":""})}$(this).css(d)};$(".NatureObject:visible",c.div).each(b);$(".NatureObject:hidden",c.div).each(b);this.triggerEvent("refresh",$.event.special.refresh,this.layer())}this.autofill();return this},time:function(b,e){var d=this.settings;if(!b){return}var f=new Date().getTime();if(!console.timeCounters){console.timeCounters={}}var c="KEY"+b.toString();if(!e&&console.timeCounters[c]){return}console.timeCounters[c]=f},timeEnd:function(c){var f=this.settings;var h=new Date().getTime();if(!console.timeCounters){return}var d="KEY"+c.toString();var e=console.timeCounters[d];if(e){var g=h-e;var b=c+": "+g+"ms";delete console.timeCounters[d]}return g},script:function(c){var d=this.settings;if(d.disablejs){return}var b=document.createElement("script");b.type="text/javascript";b.src=c;try{$("body").append(b)}catch(f){}},parseHTML:function(e){var o=this.settings;e=e.replace(/\ src=\"/ig,' imgsrc="');$("#template",o.div).html(e.replace(/\<area /ig,"<div ")).hide().children("img[imgsrc]").each(function(){if($(this).is('[imgsrc^="data:image/png"]')){$(this).attr("src",$(this).attr("imgsrc")).removeAttr("imgsrc")}else{$(this).attr("src",o.currentPrefix+$(this).attr("imgsrc")).removeAttr("imgsrc")}});$("#template",o.div).children("page[imgsrc]").each(function(){$(this).attr("src",$(this).attr("imgsrc")).removeAttr("imgsrc")});if(typeof($("#layer",o.div).attr("value"))=="undefined"){if((typeof $("#template",o.div).find("layer").attr("default"))!="undefined"){$("#layer",o.div).attr("value",$("#template",o.div).find("layer").attr("default"))}else{$("#layer",o.div).attr("value","0")}}if(typeof($("#template",o.div).find("layer").attr("target"))!="undefined"){$("#layer",o.div).attr("target",$("#template",o.div).find("layer").attr("target"))}else{$("#layer",o.div).removeAttr("target")}var k=$("#template > img",o.div);if(o.fullscreen||o.hasSize){var h=k.attr("height");o.sizeH=o.height/parseInt(k.attr("height"));o.sizeW=o.width/parseInt(k.attr("width"));k.css({width:o.width+"px",height:o.height+"px"})}else{$("#"+o.globalLoadingTarget,o.div).css({width:parseInt(k.attr("width"))+"px",height:parseInt(k.attr("height"))+"px"})}var f="_backgroupimage_"+(o.zindex++);if($("#_backgroupimage_",o.div).length==0){f="_backgroupimage_";k.appendTo($(o.div)).attr("id",f)}else{k.appendTo($(o.div)).attr("id",f).hide()}var n=$("#"+f,o.div).attr("src");var b=n.substring(0,n.length-4);var j=n.substring(b.length);var l=b+".mouseover"+j;var c=b+".mousedown"+j;var d=((typeof $("#"+f,o.div).attr("mousedown"))=="undefined")?false:true;var m=((typeof $("#"+f,o.div).attr("mouseover"))=="undefined")?false:true;var g={};if($("#template",o.div).find("debug").attr("value")=="true"){$.extend(g,{"border-style":"solid","border-width":"1px","border-color":"#0000ff"})}$("#template > map > div",o.div).remove().appendTo(o.div).each(function(){var p=false;if((typeof $(this).attr("href"))=="undefined"){p="Unknow"+o.noname;o.noname=o.noname+1}else{p=$(this).attr("href")}$(this).attr("id",p.replace(".","_")).addClass("NatureObject");var t=o.elements[$(this).attr("id")]={};t.imgsrc=n;t.imgsrc_over=l;t.imgsrc_down=c;t.imgsrc_down=c;t.mousedown=d;t.mouseover=m;if((typeof $(this).attr("target"))=="undefined"){if(typeof($("#layer",o.div).attr("target"))!="undefined"){$(this).attr("target",$("#layer",o.div).attr("target"))}}if((typeof $(this).attr("layer"))=="undefined"){if(typeof($("#template",o.div).find("layer").attr("default"))!="undefined"){$(this).attr("layer",$("#template",o.div).find("layer").attr("default"))}}var v=$(this).attr("coords").split(",");v[0]=parseInt(v[0]*o.sizeW);v[1]=parseInt(v[1]*o.sizeH);v[2]=parseInt(v[2]*o.sizeW);v[3]=parseInt(v[3]*o.sizeH);var w=(v[2]-v[0])+"";var q=(v[3]-v[1])+"";var r=$.extend({},g,{position:"absolute",left:v[0]+"px",top:v[1]+"px",width:w+"px","line-height":(q-2)+"px",height:q+"px",overflow:"hidden","z-index":o.zindex++});if((typeof $(this).attr("font"))!="undefined"){$.extend(r,{"font-family":$(this).attr("font")})}if((typeof $(this).attr("size"))!="undefined"){$.extend(r,{"font-size":parseInt($(this).attr("size"))+"px"})}if((typeof $(this).attr("color"))!="undefined"){$.extend(r,{color:$(this).attr("color")})}var s=$(this).attr("align");if(typeof s=="undefined"){$.extend(r,{"text-align":"left",valign:"middle"})}else{if(s=="topcenter"){$.extend(r,{"text-align":"center",valign:"text-top"})}else{if(s=="topleft"){$.extend(r,{"text-align":"left",valign:"text-top"})}else{if(s=="topright"){$.extend(r,{"text-align":"right",valign:"text-top"})}else{if(s=="middlecenter"){$.extend(r,{"text-align":"center",valign:"middle"})}else{if(s=="middleleft"){$.extend(r,{"text-align":"left",valign:"middle"})}else{if(s=="middleright"){$.extend(r,{"text-align":"right",valign:"middle"})}else{if(s=="bottomcenter"){$.extend(r,{"text-align":"center",valign:"text-bottom"})}else{if(s=="bottomleft"){$.extend(r,{"text-align":"left",valign:"text-bottom"})}else{if(s=="bottomright"){$.extend(r,{"text-align":"right",valign:"text-bottom"})}}}}}}}}}}$(this).removeAttr("font").removeAttr("size").removeAttr("color").removeAttr("coords").removeAttr("shape").removeAttr("href").removeAttr("align");$.extend(r,{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0)","-webkit-box-shadow":"none","-webkit-backface-visibility":"hidden"});$(this).css(r);if((typeof $(this).attr("group"))!="undefined"){var x=(typeof($(this).attr("rows"))=="undefined")?1:$(this).attr("rows");var u=(typeof($(this).attr("cols"))=="undefined")?1:$(this).attr("cols");o.self.groupResize($(this).attr("group"),x,u,$(this))}else{o.self.convertButton($(this));$(this).hide()}});$("#template > page",o.div).remove().each(function(){if(typeof($(this).attr("src"))!="undefined"){if($(this).attr("prefix")){var p=o.currentPrefix;o.self.loadfile($(this).attr("src"),$(this).attr("prefix"));o.currentPrefix=p}else{o.self.loadfile($(this).attr("src"),o.currentPrefix)}}});$("#template",o.div).empty();return o.self},groupResize:function(c,r,n,q){var t=this.settings;var g="group_"+c+"_div";var k=g+"_container";var o=(typeof q=="undefined")?$("#"+k,t.div).css("top"):parseInt(q.css("top"));var f=(typeof q=="undefined")?$("#"+k,t.div).css("left"):parseInt(q.css("left"));var d=(typeof q=="undefined")?$("#"+k,t.div).width():q.width();var p=(typeof q=="undefined")?$("#"+k,t.div).height():q.height();var m=(typeof q=="undefined")?$("#"+k,t.div).attr("layer"):q.attr("layer");q=(typeof q=="undefined")?$("div[group="+c+"]","#"+k).first():q;$("#"+k,t.div).remove();$(t.div).append('<div id="'+k+'" style="display:none; position: absolute; overflow-y: hidden; overflow-x: hidden;" groupname="'+c+'" ><ul style="position: absolute; margin: 0 0 0 0;margin: 0; padding: 0"><li id="'+g+'" style="float: left; list-style-type: none;  margin: 0 0px 0 0;"></li></ul></div>');$("#"+g,t.div).css({left:"0px",top:"0px"}).css("z-index",t.zindex++);$("#"+k,t.div).css({left:f,top:o}).attr("layer",m).css("z-index",t.zindex++);for(var l=0;l<r;l++){for(var h=0;h<n;h++){var e=q.clone(true);e.css({top:p*l,left:d*h});e.appendTo($("#"+g,t.div));e.attr("id",c+"_"+(l*n+h));e.removeAttr("cols").removeAttr("layer").removeAttr("rows").removeAttr("opacity").removeClass("NatureObject").attr("groupid",g)}}var b=$("#"+k,t.div);$("#"+g,t.div).attr("rows",r).attr("cols",n).css("height",(p*r)+"px").css("width",(d*n)+"px");b.css("height",(p*r)+"px").css("width",(d*n)+"px").addClass("NatureObject NatureGroupObject").attr("layer",q.attr("layer"));q.remove();return b},loadfile:function(e,d){var c=this.settings;c.currentPrefix=d;var b=c.currentPrefix+e+".html";if($.inArray(b,c.files)!=-1){return this}c.files.push(b);$.ajax({url:b,dataType:"html",async:false,error:function(f){},success:function(f){c.self.parseHTML(f)}});c.self.script(c.currentPrefix+e+".js");return c.self},istouch:function(){return this.settings.touch},convertButton:function(f){var e=this.settings;var h=f.attr("id");if(f.hasClass("marquee")||f.hasClass("video")||f.hasClass("player")||f.hasClass("iframe")||f.hasClass("image")||f.hasClass("input")||f.hasClass("textarea")||f.hasClass("flash")){return e.self}var d=e.elements[f.attr("id")];if((typeof f.attr("opacity"))!="undefined"){var b=f.attr("opacity").split(",");for(var k=0;k<3;k++){if(k<b.length&&parseInt(b[k])>=1){b[k]=0.99}else{if(k>=b.length-1){b.push(b[0])}}}d.opacity=b}else{d.opacity=[0.99,0.99,0.99]}f.removeAttr("opacity").css("opacity",d.opacity[0]);if(!e.transparent){if(!(f.hasClass("label"))){f.css("background-position","-"+f.css("left")+" -"+f.css("top"));if(e.fullscreen||e.hasSize){f.css("background-size",e.width+"px "+e.height+"px")}f.css("background-image","url("+d.imgsrc+")")}}if((typeof f.attr("value"))!="undefined"){f.text(f.attr("value"))}f.removeAttr("value");if(f.hasClass("label")){f.click(function(){if(typeof($(this).attr("target"))!="undefined"){e.self.target($(this).attr("target"))}})}if(f.hasClass("label")||f.hasClass("background")){return e.self}var j=function(m,q,p,c){if(typeof(m.attr("layerdisable"))!="undefined"&&p!=0){var o=m.attr("layerdisable").split(",");if($.inArray(e.self.layer(),o)!=-1){return}}var l=e.elements[m.attr("id")];$("#"+e.globalLoadingTarget,e.div).show();m.css("opacity",l.opacity[p]);try{if(m.css("background-image")!="url("+l["imgsrc"+q]+")"){if((l.mouseover&&q=="_over")||(l.mousedown&&q=="_down")||(q=="")){if(!e.transparent){m.css("background-image","url("+l["imgsrc"+q]+")")}}}}catch(n){}$("#"+e.globalLoadingTarget,e.div).hide();if(c){if(typeof(m.attr("target"))!="undefined"){e.self.target(m.attr("target"))}m.trigger("binding")}};if(!e.touch){f.hover(function(){j($(this),"_over",1,false)},function(){j($(this),"",0,false)}).click(function(){j($(this),"_over",1,true)}).mousedown(function(){j($(this),"_down",2,false)}).mouseup(function(){j($(this),"_over",1,false)})}else{var g=function(m,l){var n=l.originalEvent.touches;for(var c=0;c<n.length;c++){}n=l.originalEvent.targetTouches;for(var c=0;c<n.length;c++){}n=l.originalEvent.changedTouches;for(var c=0;c<n.length;c++){}};f.bind("touchstart",function(l){if(l.originalEvent.touches.length>1){var m=l.originalEvent.touches;for(var c=0;c<m.length;c++){j($("#"+m[c].target.id,e.div),"",0,false)}}else{j($(this),"_down",2,false)}});f.bind("touchmove",function(c){j($(this),"",0,false)});f.bind("touchend",function(c){j($(this),"",0,true)});f.bind("touchcancel",function(c){j($(this),"",0,false)})}return e.self},convertTags:function(){var b=this.settings;var c=function(h,d,g,f){if(h.hasClass(d)){var e="<"+d+" "+g+' id="'+h.attr("id")+'"></'+d+">";h.removeAttr("id").append(e);h.children(d).attr("style",h.attr("style")).css({outline:"none","-webkit-user-modify":"read-write-plaintext-only",display:"",position:""}).attr("placeholder",h.attr("placeholder"))}};$(".video",b.div).each(function(){c($(this),"video",'playid="0" autoplay="autoplay"',"inline")});$(".iframe",b.div).each(function(){c($(this),"iframe","")});$(".image",b.div).each(function(){c($(this),"image","","inline")});$(".input",b.div).each(function(){c($(this),"input","")});$(".textarea",b.div).each(function(){c($(this),"textarea")});return b.self},initLayer:function(){var b=this.settings;$("div.NatureObject",b.div).each(function(){if(typeof($(this).attr("layer"))=="undefined"||$(this).attr("layer")==""){$(this).show();$(this).trigger("show");$(this).removeAttr("layer")}});return b.self},show:function(){var b=this.settings;b.hide=false;$(b.div).show();this.target(this.layer())},hide:function(){var b=this.settings;$("div.NatureObject[layer]",b.div).each(function(){$(this).css("display","none");$(this).trigger("hide")});$(b.div).css("display","none");b.hide=true},layer:function(){var b=this.settings;return $("#layer",b.div).attr("value")},target:function(b){var c=this.settings;if(!this.triggerEvent("preExit",$.event.special.preExit,this.layer())){return}b=b+"";c.self.time("target ["+b+"]",true);this.triggerEvent("postExit",$.event.special.postExit,this.layer());$("#layer",c.div).attr("value",b);if(c.hide){return}this.triggerEvent("preEnter",$.event.special.preEnter,b);$("div.NatureObject[layer]",c.div).each(function(){var e=$(this).attr("layer").split(",");if($.inArray(b,e)!=-1){$(this).show();if($(this).hasClass("NatureGroupObject")){if(typeof($(this).attr("groupname"))!="undefined"){var d=$(this).attr("groupname")}}if(typeof(c.groups[d])=="object"){if(c.groups[d].refresh!=undefined){c.groups[d].refresh()}}$(this).trigger("show")}else{$(this).css("display","none");$(this).trigger("hide")}});c.self.timeEnd("target ["+b+"]");this.fireEvent("target",b);this.triggerEvent("target",$.event.special.target,b);this.triggerEvent("postEnter",$.event.special.postEnter,b);this.autofill();return c.self},eventValue:true,triggerEvent:function(d,f,c){var b=true;this.eventValue=true;try{for(var g in f.listeners){f.listeners[g].trigger(d,[this,c]);b=b&&this.eventValue}}catch(h){}return b&&d=="preExit"},fireEvent:function(d,c){var f=this.settings;if(typeof(f.listeners[d])!="undefined"){var b=f.listeners[d];for(var g in b){try{b[g](c)}catch(h){}}}},listener:function(c,e){var d=this.settings;if(typeof e=="function"){if(typeof(d.listeners[c])!="undefined"){var b=d.listeners[c];b.push(e)}else{var b=new Array();b.push(e);this.removeListener(c);d.listeners[c]=b}}},removeListener:function(c,g){var d=this.settings;if(typeof(d.listeners[c])!="undefined"){var b=d.listeners[c];if(b.length==1){delete d.listeners[c]}else{var h=new Array();for(var e in b){if(b[e]!=g){h.push(b[e])}}delete d.listeners[c];d.listeners[c]=h}}},marquee:function(c,d){var b=this.settings;var e=0;b.self.marquee.effect="fade";b.self.marquee.speed=3000;b.self.marquee.delay=1000;b.self.marquee.timeout=6000;if(typeof d=="function"){b.self.marquee.handler=d}$.ajax({url:c,dataType:"json",cache:false,async:false,handler:d,success:function(h){$(".marquee",b.div).unbind();$(".marquee",b.div).html("");b.self.marqueeItem("　");if(typeof this.handler=="function"){this.handler(h)}else{try{b.self.marquee.effect=h.effect;b.self.marquee.speed=h.speed;b.self.marquee.delay=h.delay;b.self.marquee.timeout=h.timeout}catch(j){}try{var f=h.items;if(f.length>0){for(var g=0;g<f.length;g++){b.self.marqueeItem(f[g]["msg"])}}}catch(j){}}if($(".marquee",b.div).html()==""){b.self.marqueeItem("demo")}if($(".marquee > div",b.div).length==1){$(".marquee",b.div).append($(".marquee",b.div).html())}$(".marquee",b.div).cycle({fx:b.self.marquee.effect,speed:b.self.marquee.speed,delay:b.self.marquee.delay,timeout:b.self.marquee.timeout,after:function(){e=e+1;if(e>$(".marquee > div",b.div).size()){b.self.marquee(b.self.marquee.url,b.self.marquee.handler)}}})}});return b.self},marqueeItem:function(c){var b=this.settings;if(c=="　"){}else{if(c=="demo"){$(".marquee",b.div).html("<div>\n$.NatureFace.js plugin demo.\n</div>")}else{$(".marquee",b.div).append("<div>\n"+c+"\n</div>")}}return b.self},subscribe:function(c,e,b,g){var d=this.settings;$(document).everyTime(b,c,function(){$.ajax({url:e,dataType:"json",cache:false,async:false,success:function(f){if(f.length>0){if(typeof g=="function"){g(f)}}}})});return d.self},unsubscribe:function(b){var c=this.settings;$(document).stopTime(b);return c.self},jsonListing:function(j,h,c){var q=this.settings;var n=$("#group_"+j+"_div",q.div);var f=$("[group="+j+"]:eq(0)",q.div);var k,m=parseInt(n.attr("cols"))>0?parseInt(n.attr("cols")):1;var b=$("#group_"+j+"_div_container",q.div);$('[group="'+j+'"]',q.div).filter(":not(:eq(0))").remove();f.empty();for(var o=0;o<h.length;o++){if(o>=1){k=f.clone().empty()}else{k=f}k.attr("id",f.attr("group")+"_"+o);var p=Math.ceil((o+1)/m)-1;var e=o%m;var l=(parseInt(f.css("top"))+(parseInt(f.height())*p))+"px";var d=(parseInt(f.css("left"))+(parseInt(f.width())*e))+"px";k.css({top:l,left:d});if(o!=0){k.appendTo(n)}if(typeof c=="function"){c(k,h[o])}}if(h.length>0){n.css("height",(parseInt(k.css("top"))+k.height()+1)+"px");n.parent().css("height",n.height()+1)}if(typeof(q.groups[j])=="undefined"){q.groups[j]=new iScroll(b.attr("id"),{hScrollbar:false,hScroll:false,onTouchEnd:function(){b.trigger("onTouchEnd")},onScrollEnd:function(){b.trigger("onTouchEnd")}})}q.groups[j].refresh()},listing:function(e,b,c,h,f){var d=this.settings;if(!f){f=1}$.ajax({groupname:e,url:b+f,subupdate:c,subpage:h,page:f,dataType:"json",cache:false,async:false,pureurl:b,success:function(o){var r=this.groupname;var s=$("[group="+r+"]",d.div);var u=$("#group_"+r+"_div",d.div);var g=$("#group_"+r+"_div_container",d.div);var l=this.pureurl;var j=this.page;var k=this.subupdate;var q=this.subpage;var p,t=s.last(),n=s;for(var m=0;m<o.items.length;m++){var v=o.absoluteposition+m-1;if(v>=s.length){p=t.clone().empty();p.attr("id",t.attr("group")+"_"+v);p.css({top:(parseInt(t.css("top"))+t.height())+"px",height:(parseInt(p.css("line-height"))+2)+"px"}).appendTo(u);if(typeof k=="function"){k(p,o.items[m])}}else{p=$(s[v]);if(typeof k=="function"){k(p,o.items[m])}if(v>=1){t=$("#"+$(s[v]).attr("group")+"_"+(v-1),d.div);p.css("top",parseInt(t.css("top"))+t.height())}}t=p}if(o.items.length>0){u.css("height",(parseInt(p.css("top"))+p.height()+1)+"px");u.parent().css("height",u.height()+1)}if(j<o.pagecount){g.one("onTouchEnd",function(){d.self.listing(r,l,k,q,j+1)})}if(typeof(d.groups[r])=="undefined"){d.groups[r]=new iScroll(g.attr("id"),{hScrollbar:false,hScroll:false,onTouchEnd:function(){g.trigger("onTouchEnd")},onScrollEnd:function(){g.trigger("onTouchEnd")}})}d.groups[r].refresh()}});return d.self},autofill:function(){setTimeout('$("div[autofill]", "'+this.settings.div+'").autofill()',3)},jsonTable:function(h,e,d,f,b){var o=this.settings;if(typeof(o.groups[h])!="undefined"){delete o.groups[h]}var j=$(".NatureObject[binding="+h+"\\.left]",o.div);var m=$(".NatureObject[binding="+h+"\\.right]",o.div);var k=$("[group="+h+"]",o.div);var n=k.length>0?Math.ceil(e.length/k.length):1;if(!b){b=n}var c=b>n?n:b;o.groups[h]=e;o.groups[h].subupdate=d;o.groups[h].subclear=f;o.groups[h].page=c;for(i=0;i<k.length;i++){$(k[i]).empty();var l=(c-1)*k.length+i;if(l<e.length){d($(k[i]),e[l],c,n)}else{f($(k[i]),{},c,n)}}if(j.length>0){j.unbind("binding");if(c>1){j.bind("binding",function(){var g=$(this).attr("binding");var q=g.substring(0,g.length-5);var p=o.groups[q];o.self.jsonTable(q,p,p.subupdate,p.subclear,p.page-1)})}}if(m.length>0){m.unbind("binding");if(n>c){m.bind("binding",function(){var g=$(this).attr("binding");var q=g.substring(0,g.length-6);var p=o.groups[q];o.self.jsonTable(q,p,p.subupdate,p.subclear,p.page+1)})}}},binding:function(f,b,c,e,h){var d=this.settings;if(!h){h=1}$.ajax({group:f,url:b+h,subupdate:c,subclear:e,page:h,dataType:"json",cache:false,async:false,pureurl:b,success:function(n){if(typeof(d.groups[this.group])!="undefined"){delete d.groups[this.group]}var m=$(".NatureObject[binding="+this.group+"\\.left]",d.div);var p=$(".NatureObject[binding="+this.group+"\\.right]",d.div);var o=$(".NatureObject[binding="+this.group+"\\.pageinfo]",d.div);var g=$("[group="+this.group+"]",d.div);n.url=this.pureurl;n.subupdate=this.subupdate;n.subclear=this.subclear;d.groups[this.group]=n;if(n.pagecount>1&&o.length>0){$(o).text(n.absolutepage+"頁／"+n.pagecount+"頁")}else{if(o.length>0){$(o).text("1頁／1頁")}}var l=0;for(l=0;l<n.items.length;l++){if(typeof n.subupdate=="function"){$(g[l]).empty();n.subupdate($(g[l]),n.items[l])}}for(var k=l;k<g.length;k++){if(typeof n.subclear=="function"){n.subclear($(g[k]))}}if(m.length>0){m.unbind("binding");m.bind("binding",function(){var j=$(this).attr("binding");var r=j.substring(0,j.length-5);var q=d.groups[r];d.self.binding(r,q.url,q.subupdate,q.subclear,q.absolutepage-1)})}if(p.length>0){p.unbind("binding");p.bind("binding",function(){var j=$(this).attr("binding");var r=j.substring(0,j.length-6);var q=d.groups[r];d.self.binding(r,q.url,q.subupdate,q.subclear,q.absolutepage+1)})}}});return d.self}};$.extend({NatureFace:{init:function(c,e,d,b,f){$.NatureFace=new a(c,e,d,b,f);return $.NatureFace}}})();return window.NatureFace=a};if(typeof define=="function"){define(NatureFaceOrig)}else{NatureFaceOrig()};